---
title: "Getting Started"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  error   = FALSE,
  cache.path = file.path(R.cache::getCachePath(),
                         "chariotViz",
                         "vignettes"),
  cache = TRUE
)
```

```{r setup}
library(chariotViz)
```

```{r,cache=T}
omop_relationships <- 
  fetch_omop(version_key = get_version_key())
```

```{r}
omop_nodes_and_edges <- 
  create_nodes_and_edges(omop_relationships = omop_relationships)
```


```{r}
omop_nodes_and_edges <- 
  omop_nodes_and_edges %>% 
  add_tooltip() %>%
  map_node_attributes() %>% 
  map_edge_attributes()
```

```{r}
omop_graph <- 
  construct_graph(omop_nodes_and_edges)
```


```{r}
hemonc_relationships <- 
  omop_relationships %>% 
  filter_omop_relationships(
    vocabulary_id_1 == "HemOnc",
    vocabulary_id_2 == "HemOnc",
    concept_class_id_1 != concept_class_id_2
  )
```

```{r}
hemonc_graph <- 
  create_nodes_and_edges(hemonc_relationships) %>% 
  add_tooltip() %>% 
  map_node_attributes() %>% 
  map_edge_attributes() %>% 
  construct_graph()
```

```{r}
chariotViz(hemonc_graph)
```

```{r}
hemonc_graph2 <- 
  hemonc_graph %>% 
  remap_fillcolor_by_concept_class()

chariotViz(hemonc_graph2)
```

